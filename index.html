<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>웹접근성 가이드 - Accessibility Guidelines</title>
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/custom.css">
		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="https://highlightjs.org/static/demo/styles/monokai-sublime.css">
		<link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/fira.css">
		<link rel='stylesheet' href='lib/font/devicons/devicons.css'>
		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<span style="height:4.5em;width:4.5em;display:inline-flex;align-items:center;justify-content:center;border-radius:50%;background-color:#000">
						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:100%;fill:#fff">
							<path d="M12,2c1.1,0,2,0.9,2,2s-0.9,2-2,2s-2-0.9-2-2S10.9,2,12,2z M21,9h-6v13h-2v-6h-2v6H9V9H3V7h18V9z"></path>
						</svg>
					</span>
					<h1 style="margin-bottom:60px">
						#a11y 웹접근성 개선<br>
						<span style="font-size:30px">카테고리, 레이어팝업</span>
					</h1>
					<p>2018. 12. 11</p>
					<p>IT 개발2팀 UI파트 - 김재호</p>
				</section>

				<section>
					<h2>The Agenda</h2>
					<ul>
						<li>카테고리 (Navigation)</li>
						<li>레이어 팝업 (Modals)</li>
					</ul>
				</section>

				<section>
					<section>
						<h2>카테고리 (Navigation)</h2>
					</section>

					<section>
						<h3>기존 방식</h3>
						<p>마우스 오버 시 하위 메뉴 열림, 키보드 초점 이동 시 하위 메뉴 열림</p>

						<iframe width="100%" height="250" src="https://jsfiddle.net/hohoya33/7vynqbh4/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>

						<pre><code class="js">
$('.ctg_mall_lst').on('mouseenter focusin', '.ctg_top_mn', function(e){
	// ...
});
                        </code></pre>
					</section>

					<section>
						<h3>카테고리 항목이 늘어나면..🤔</h3>
						<p>스크린리더기에 의존하는 사용자,<br> 마우스를 사용할 수 없는 사용자에게는 유용하지 않음</p>
						<img width="90%" src="img/category_all.png" alt="">
					</section>

					<section>
						<h3>초점이동 → 컨텐츠 탐색을 위한 이동</h3>
						<p>초점을 이동 하거나 마우스를 올리는 것은<br>항상 기능을 실행하기 위한 의도로 보기 어려움</p>
						<ul>
							<li>의도하지 않은 기능 실행</li>
							<li>의도하지 않은 정보 인식</li>
							<li>정보의 선택권 보장 X</li>
						</ul>
					</section>

					<section>
						<h3>웹 접근성 지침</h3>
						<table>
							<colgroup>
							<col style="width:12%">
							<col style="width:88%">
							</colgroup>
							<thead>
								<tr>
									<td>원칙 3</td>
									<td>이해의 용이성</td>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>3.1</td>
									<td>가독성</td>
								</tr>
								<tr>
									<td>3.1.1</td>
									<td>기본 언어 표시 (주로 사용하는 언어를 명시해야 한다)</td>
								</tr>
								<tr>
									<td style="color:#13DAEC">3.2 </td>
									<td style="color:#13DAEC">예측 가능성 (콘텐츠의 기능과 실행결과는 예측 가능해야 한다)</td>
								</tr>
								<tr>
									<td style="color:#13DAEC">3.2.1</td>
									<td style="color:#13DAEC">사용자 요구에 따른 실행 - 사용자가 의도하지 않은 기능 (새 창, 초점 변화 등)은 실행되지 않아야 한다.</td>
								</tr>
								<tr>
									<td>3.3</td>
									<td>콘텐츠의 논리성 (콘텐츠는 논리적으로 구성해야 한다)</td>
								</tr>
								<tr>
									<td>3.3.1</td>
									<td>...</td>
								</tr>
							</tbody>
						</table>
					</section>

					<section>
						<h3>예측 가능성</h3>
						<p>사용자가 의도하지 않는 기능이 자동으로 실행 되지 않도록 개발</p>
						<ul>
							<li>초점이동 → 기능 실행 NO</li>
							<li>Enter 입력 → 하위 메뉴 확장</li>
							<li>하위 메뉴 확장/축소 시 적절한 피드백 제공</li>
						</ul>
					</section>


					<section>
						<h3>WAI-ARIA</h3>
						<ul>
							<li><a href="https://www.w3.org/WAI/standards-guidelines/aria/" target="_blank">W3C WAI-ARIA</a>는 HTML의 접근성 문제를 보완하는 W3C 명세</li>
							<li>스크린리더 사용자들이 웹 콘텐츠를 쉽게 이용할 수 있도록 새로운 방법을 정의</li>
							<li>HTML 요소에 role 또는 aria-* 속성을 추가</li>
							<li>콘텐츠의 역할(roles), 상태(states), 속성(properties) 정보를 스크린리더에 제공</li>
						</ul>
					</section>

					<section>
						<h3>WAI-ARIA 참고 사항</h3>
						<ul>
							<li>모든 HTML 요소에 무분별하게 사용 금지</li>
							<li>대부분의 HTML 요소와 속성을 흉내 (WAI-ARIA 사용 최소화)</li>
							<li>사용하기에 앞서 HTML을 의미 있게 사용했는지 충분히 검토</li>
						</ul>
						<pre><code class="html">
<!-- Better: ARIA 역할과 유사한 의미를 가진 고유 HTML 요소를 사용 -->
<nav>...</nav>

<!-- Good -->
<div role="navigation">...</div>

<!-- Bad -->
<nav role="navigation">...</nav>
                        </code></pre>
					</section>


					<section>
						<h3>카테고리 버튼</h3>
						<ul>
							<li><span style="color:#13daec">aria-haspopup="true"</span> 요소에 팝업 컨텍스트 메뉴 또는 하위 메뉴가 있음</li>
							<li><span style="color:#13daec">aria-expanded="true|false"</span> 요소가 제어하는 ​​대상이 현재 확장 또는 축소 상태를 나타냄</li>
						</ul>

						<pre><code class="html">
<button aria-expanded="false" aria-haspopup="true">
    통합 카테고리 보기
</button>
                        </code></pre>

                        <pre><code class="js">
// 레이어 열기
$('button').attr('aria-expanded', 'true');

// 레이어 닫기
$('button').attr('aria-expanded', 'false');

                        </code></pre>
					</section>

					<section>
						<h3>VoiceOver 테스트</h3>
						<iframe width="100%" height="570" src="https://jsfiddle.net/hohoya33/2mfs3a41/embedded/result,js,html/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
					</section>

					<section>
						<h3>의미에 맞는 HTML 작성</h3>
						<ul>
							<li>a 요소는 Enter 키만으로 실행</li>
							<li>button 요소는 Enter, Space 키로 실행 가능</li>
							<li>스크린리더 사용자는 a 요소로부터 '버튼' 설명을 듣고 Space 키 사용 시 혼란</li>
							<li>올바른 HTML의 선택은 사용자 경험과 접근성 측면에서 모두 중요</li>
						</ul>
					</section>

					<section>
						<h3>카테고리 레이어</h3>
						<ul>
							<li><span style="color:#13daec">aria-hidden="true|false"</span> 화면에서 숨기면 true, 화면에 표시하면 false </li>
							<li><span style="color:#13daec">true</span> 값을 가지면 스크린리더 접근이 불가능 (포커스를 차단하지 않음)</li>
						</ul>

						<pre><code class="html">
<div class="ctg_total_layer" aria-hidden="true" style="display:none">
	...
</div>
                        </code></pre>

                        <pre><code class="js">
// 레이어 열림
$('.ctg_total_layer').show().attr('aria-hidden', 'false');

// 레이어 닫힘
$('.ctg_total_layer').hide().attr('aria-hidden', 'true');
                        </code></pre>
					</section>

					<section>
						<h3>VoiceOver 테스트</h3>
						<iframe width="100%" height="500" src="https://jsfiddle.net/hohoya33/37ja6u5o/embedded/result,html/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
					</section>


					<section>
						<h3>카테고리 메뉴 (depth. 1)</h3>
						<ul>
							<li><span style="color:#13daec">aria-label="string"</span> 간결한 설명</li>
							<li><span style="color:#13daec">role="navigation"</span> 연결된 페이지를 탐색하기 위한 링크 모음</li>
							<li>속성을 사용하기 전 HTML5 &lt;nav&gt; 요소를 먼저 고려</li>
						</ul>

						<pre><code class="html">
<ul class="ctg_mall_lst" role="navigation" aria-label="SSG 통합카테고리">
	<li class="ctg_top_mn">
		<a href="http://www.ssg.com" class="ctg_top_lnk">SSG.COM</a>
	</li>
</ul>
                        </code></pre>
					</section>


					<section>
						<h3>카테고리 메뉴 이슈</h3>
						<ul>
							<li>두 가지 용도로 사용되는 메뉴</li>
							<li>해당 메뉴 클릭 시 링크 이동, 마우스 오버 시 하위 메뉴 열림</li>
							<li>초점 이동 후, Enter 키 입력 시 링크 이동 되는 문제 (하위 메뉴 접근 불가)</li>
						</ul>
					</section>

					<section>
						<h3>해결 방법</h3>
						<ul>
							<li>하위 메뉴 열기/닫기 버튼을 별도로 추가 (기본 숨김)</li>
							<li>키보드 포커스 접근 시(탭 키 입력) 버튼 노출</li>
						</ul>
					</section>


					<section>
						<h3>하위 메뉴 보기 버튼 추가</h3>
						<ul>
							<li>a 태그 aria-label 몰 바로가기 설명 추가</li>
							<li>키보드 포커스 접근 시, 하위 메뉴 보기 버튼 활성화</li>
						</ul>

						<pre><code class="html">
<li class="ctg_top_mn">
	<a aria-label="SSG.COM 바로가기" href="http://www.ssg.com" class="ctg_top_lnk">SSG.COM</a>
	<!-- 하위 메뉴가 있으면 버튼 추가 -->
	<button style="display:none" aria-expanded="false" class="ctg_a11y_btn">
		<span class="blind">SSG.COM 하위 메뉴</span>
	</button>
</li>
                        </code></pre>

                        <pre><code class="js">
$('.ctg_mall_lst').on('focusin', '.ctg_top_mn', function(e){
	var welTarget = $(e.currentTarget);
	welTarget.find('>.ctg_a11y_btn').show();
});
                        </code></pre>
					</section>

					<section>
						<h3>VoiceOver 테스트</h3>
						<iframe width="100%" height="500" src="https://jsfiddle.net/hohoya33/dfewLs2x/embedded/result,js,html/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
					</section>

					<section>
						<h3>카테고리 하위 메뉴 (depth. 2)</h3>
						<ul>
							<li><span style="color:#13daec">role="menubar"</span> 일반적으로 가로로 표시되는 메뉴 모음</li>
							<li><span style="color:#13daec">role="menu"</span> 사용자에게(실행) 선택 목록을 제공하는 유형 (세로방향)</li>
							<li><span style="color:#13daec">role="menuitem"</span> menubar 또는 menu 모음에 포함된 옵션 항목</li>
						</ul>

						<pre><code class="html">
<div class=" ctg_sub_area" aria-hidden="true">
	<ul class="ctg_sub_lst" role="menu">
		<li class="ctg_sub_mn">
			<a role="menuitem" aria-label="패션 바로가기" href="#" class="ctg_sub_lnk">패션</a>
			<button aria-expanded="false" class="ctg_a11y_btn">
				<span class="blind">패션 하위 메뉴 5개의 항목</span>
			</button>
		</li>
	</ul>
</div>
                        </code></pre>
					</section>


					<section>
						<h3>하위 메뉴 보기 버튼 이벤트</h3>
                        <pre><code class="js">
$('.ctg_mall_lst').on('click', '.ctg_a11y_btn', function(e){
	var welTarget = $(e.currentTarget);
	var welParentList = welTarget.parent();

	if (welTarget.hasClass('on')) { //축소
		welParentList.find('>.ctg_sub_area').attr('aria-hidden', 'true');
		welTarget.removeClass('on').attr('aria-expanded', 'false');
	} else { //확장
		welParentList.find('>.ctg_sub_area').attr('aria-hidden', 'false');
		welParentList.siblings().find('.ctg_a11y_btn').removeClass('on').attr('aria-expanded', 'false').hide();
		welTarget.addClass('on').attr('aria-expanded', 'true');
	}
});
                        </code></pre>
					</section>


					<section>
						<h3>VoiceOver 테스트</h3>
						<iframe width="100%" height="400" src="https://jsfiddle.net/hohoya33/cqh5v13n/embedded/result,js,html/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
					</section>


					<section>
						<h3>Esc 입력 → 메뉴 닫기</h3>

                        <pre><code class="js">
$('.ctg_total_layer').on('keydown.a11y', function(e){
	if (e.keyCode === 27) { // ESC
		var aActiveMenu = $('.ctg_mall_lst').find('li.on');
		var nActive = aActiveMenu.length;

		if (nActive) { //활성화된 메뉴 닫기
			var welCurrentMenu = $(aActiveMenu.get(nActive - 1));
			welCurrentMenu.removeClass('on');
			welCurrentMenu.find('.ctg_a11y_btn').removeClass('on').attr('aria-expanded', 'false');
			welCurrentMenu.find('>a').focus();

		} else { //카테고리 레이어 닫기
			$('.ctg_total_layer').hide().attr('aria-hidden', 'true');
			$('.ctg_open_btn').removeClass('on').attr('aria-expanded', 'false').focus();
		}
	}
});
                        </code></pre>
					</section>

					<section>
						<h3>최종 결과물</h3>
						<iframe width="100%" height="400" src="https://jsfiddle.net/hohoya33/3dyozftc/embedded/result,js,html/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
					</section>

				</section>


				<section>
					<section>
						<h2>레이어 팝업 (Modals)</h2>
					</section>

					<section>
						<h2>기존 방식</h2>
						<ul>
							<li>버튼 클릭 → 레이어 팝업 열림</li>
							<li>레이어 팝업이 활성화되면 나머지 부분은 일반적으로 흐리게 표시</li>
							<li>외부 컨텐츠와 상호작용 불가능 (본문 차단)</li>
							<li>레이어 팝업에 집중</li>
							<li>작업이 끝나면 레이어 팝업 닫기</li>
						</ul>
						<p>시각적으로는 모든 동작이 명확하고 사용자는 레이어 팝업과 상호작용</p>
					</section>

					<section>
						<iframe width="100%" height="600" src="https://jsfiddle.net/hohoya33/tegyap1x/embedded/result/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
					</section>

					<section>
						<h2>스크린리더 사용자</h2>
						<ul>
							<li>버튼 클릭 → 레이어 팝업이 열린다는 정보 인지 불가 (예측 가능성)</li>
							<li>본문 위 레이어 팝업을 띄웠지만 포커스는 여전히 본문에 위치 (콘텐츠의 논리성)</li>
							<li>레이어 팝업 닫기 후, 다음 포커스의 위치</li>
						</ul>
						<p>모든 사용자가 시각적으로 웹사이트를 볼 수있는 것은 아니므로 접근성 개선 필요</p>
					</section>

					<section>
						<h2>접근성 향상</h2>
						<ul>
							<li>버튼, 레이어 팝업 → 레이어 팝업을 예측 할 수 있는 적절한 피드백 제공</li>
							<li>초점의 논리적 이동 → 활성화 시 레이어 팝업 내 포커스 이동,<br>열려있는 동안 내부에서 포커스 트랩 (외부로 탐색 제한)</li>
							<li>레이어 팝업 닫기 → 열리기 전 마지막 위치했던 포커스로 이동</li>
						</ul>
					</section>


					<section>
						<h2>적절한 의미 제공</h2>
					</section>


					<section>
						<h2>레이어 팝업 버튼</h2>
						<ul>
							<li><span style="color:#13daec">aria-haspopup="dialog"</span> 요소에 연결되어 있는 팝업(메뉴, 대화상자 등) 정보를 제공</li>
							<li>[false|true|menu|listbox|tree|grid|dialog] (ARIA 1.1)</li>
						</ul>

                        <pre><code class="html">
<button class="dialog_open" aria-haspopup="dialog">상품 퀵뷰</button>
                        </code></pre>
					</section>


					<section>
						<h2>레이어 팝업</h2>
						<ul>
							<li><span style="color:#13daec">aria-modal="true|false"</span> 요소가 모달인지 여부를 나타냄 (ARIA 1.1)</li>
							<li><span style="color:#13daec">aria-labelledby="ID"</span> 속성을 통해 레이어 팝업 제목을 참조 (설명할 다른 참조 요소가 있을 경우)</li>
							<li><span style="color:#13daec">aria-describedbyon=ID"</span> 레이어 팝업에 대한 설명을 제공</li>
							<li>&lt;dialog&gt; 요소를 지원하면 role="dialog" 대신 &lt;dialog&gt; 사용 (No support: Safari, Edge Mobile)</li>
						</ul>

                        <pre><code class="html">
<div id="quick_view" role="dialog" aria-modal="true" aria-labelledby="quick_title">
	<div role="document">
		<h2 id="quick_title">제목입니다.</h2>
	</div>
</div>
                        </code></pre>
					</section>


					<section>
						<h2>초점의 논리적 이동</h2>
					</section>


					<section>
						<h2>포커스 제어</h2>
						<p>기본적으로 div, h1 요소는 초점을 맞출 수 없음<br>tabindex 속성을 추가하여 포커스 가능</p>
						<ul>
							<li><span style="color:#13daec">tabindex="-1"</span> 키보드 tab키를 눌러서 초점을 받을 수 없음. 스크립트 focus() 메서드 사용하여 포커스 가능</li>
							<li><span style="color:#13daec">tabindex="0"</span> 요소에 포커스 가능. DOM 위치에 따라 순서대로 포커스 이동</li>
							<li><span style="color:#13daec">tabindex="1"</span> 가장 먼저 초점을 받을 수 있음. 그러나 자연스러운 탭 순서를 방해 (안티패턴)</li>
						</ul>
					</section>


					<section>
						<h2><a href="https://jsfiddle.net/hohoya33/kmjsd8qb/embedded/result" target="_blank">tabindex 테스트</a></h2>
						<iframe width="100%" height="360" src="https://jsfiddle.net/hohoya33/kmjsd8qb/embedded/result,html,js/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
					</section>


					<section>
						<h2>레이어 팝업 열기</h2>
						<p>레이어 팝업을 포커스 가능하게 만들고 자바스크립트로 포커스를 지정</p>
						<!-- <p>레이어 팝업 영역으로 초점 맞추기</p> -->

                        <pre><code class="html">
<div id="quick_view" role="dialog" aria-modal="true" aria-labelledby="quick_title">

</div>
                        </code></pre>
                        <pre><code class="js">
function showModal() {
	$('#quick_view').show().attr('tabindex', '0').focus();
}
                        </code></pre>
					</section>


					<section>
						<h2>레이어 팝업 닫기</h2>
						<p>레이어 팝업이 닫히면 열기 전 활성화 된 요소로 포커스 반환</p>

                        <pre><code class="js">
var welLastFocused;

function showModal() {
	// 마지막 포커스된 요소 저장
	welLastFocused = document.activeElement;
	$('#quick_view').show().attr('tabindex', '0').focus();
}
function hideModal() {
	// 마지막 포커스를 얻은 요소로 포커스를 반환
	welLastFocused.focus();
	$('#quick_view').hide().removeAttr('tabindex');
}
                        </code></pre>
					</section>


					<section>
						<iframe width="100%" height="600" src="https://jsfiddle.net/hohoya33/zdq15wcv/embedded/result,html,js/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
					</section>


					<section>
						<h2>내부에서 포커스 트랩</h2>
						<p>열린 상태에서 포커스가 밖으로 나갈 수 없도록<br>레이어 팝업 내부에서 앞뒤로(tab/shift + tab) 포커스 트랩</p>
					</section>

					<section>
                        <pre><code class="js">
function showModal() {
	// ...
	// 활성화 되는 동안 keyup 이벤트, 닫기 시 이벤트 제거
	$('#quick_view').on('keyup', trapTabKey);
}
function trapTabKey(e) {
	var aFocusable = $('#quick_view').find('*').filter('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]');
	var firstTabStop = aFocusable[0]; // 첫번째 포커스 요소
	var lastTabStop = aFocusable[aFocusable.length - 1]; // 마지막 포커스 요소

	if (e.keyCode === 9) {
		if (e.shiftKey) { // SHIFT + TAB

		} else { // TAB

		}
	}
}
                        </code></pre>
					</section>


					<section>
                        <pre><code class="js">
function trapTabKey(e) {
	// ...
	if (e.keyCode === 9) {
		// 포커스 가능 요소가 없으면
		if (!aFocusable.length) { e.preventDefault(); }

		if (e.shiftKey) { // SHIFT + TAB
			if (document.activeElement === firstTabStop) {
				e.preventDefault();
				lastTabStop.focus(); // 마지막 요소로 이동
			}
		} else { // TAB
			if (document.activeElement === lastTabStop) {
				e.preventDefault();
				firstTabStop.focus(); // 첫번째 요소로 이동
			}
		}
	}
}
                        </code></pre>
					</section>


					<section>
						<h2>레이어 팝업 닫기 (Esc key)</h2>
						<p>사용자가 키보드를 통해 레이어 팝업을 쉽게 닫을 수 있도록 기능 추가</p>
                        <pre><code class="js">
function trapTabKey(e) {
	// ...
   	if (e.keyCode === 27) { // ESC
		hideModal();
    }
}
                        </code></pre>
					</section>


					<section>
						<h2>최종 결과물</h2>
						<iframe width="100%" height="550" src="https://jsfiddle.net/hohoya33/1ugzckyp/embedded/result,html,js/dark/" allowfullscreen="allowfullscreen" allowpaymentrequest frameborder="0"></iframe>
					</section>

				</section>

				<section>
					<h2>감사합니다.</h2>
				</section>

			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				history: true,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>